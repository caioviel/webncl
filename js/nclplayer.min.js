ContextPlayer.prototype=new Player;
function ContextPlayer(a,b){this.synchronizedPlayers=[];this.loadingPlayers=0;this.handlers={};this.node=a;this.media=[];this.context=[];this.port=[];this.pausedMediaList=[];this.pausedContextList=[];this.isCreated=!1;this.htmlPlayer="";this.isPlaying=!1;this.isStopped=!0;this.presentation=b;this.htmlPlayer=a.id?b.getDivId(a.id):b.bodyDiv;$("#"+b.contextsDiv).append("<div class='context' id='"+this.htmlPlayer+"'></div>");this.htmlPlayer="#"+this.htmlPlayer;$(this.htmlPlayer).data("player",this);$(this.htmlPlayer).data("property",
[]);this.bindEvents()}ContextPlayer.prototype.syncPlayer=function(a){this.synchronizedPlayers.push(a.popcornPlayer);this.loadingPlayers++};ContextPlayer.prototype.notify=function(a){if(a)if(2<=a.popcornPlayer.readyState())this.notify();else $(a.htmlPlayer).one("canplaythrough",$.proxy(function(){this.notify()},this));else if(0==--this.loadingPlayers)for(i in this.synchronizedPlayers)this.synchronizedPlayers[i].play()};
ContextPlayer.prototype.create=function(){if(!this.isCreated){this.isCreated=!0;for(i in this.node.media)this.media[this.node.media[i].id]=new MediaPlayer(this.node.media[i],this);for(i in this.node.context)this.context[this.node.context[i].id]=new ContextPlayer(this.node.context[i],this.presentation);for(i in this.node.port)this.port[this.node.port[i].id]=this.node.port[i];for(i in this.node.property)this.setProperty(this.node.property[i].name,this.node.property[i].value);this.bindLinks()}return this};
ContextPlayer.prototype.start=function(a){if(this.isStopped){this.isCreated||this.create();this.isPlaying=!0;this.isStopped=!1;if(a)this.startPort(this.port[a]);else for(i in this.port)this.startPort(this.port[i]);$(this.htmlPlayer).trigger("presentation.onBegin",[a])}};
ContextPlayer.prototype.startPort=function(a){switch(a.component._type){case "context":this.context[a.component.id]?a.nodeInterface?(this.context[a.component.id].create(),this.context[a.component.id].port[a.nodeInterface.id]?this.context[a.component.id].start(a.nodeInterface.id):Debugger.error(Debugger.ERR_INVALID_CONTEXT_REFERENCE,"port",[a.id,"nodeInterface",a.nodeInterface.id])):this.context[a.component.id].start():Debugger.error(Debugger.ERR_INVALID_CONTEXT_REFERENCE,"port",[a.id,"component",
a.component.id]);break;case "media":a.nodeInterface?this.media[a.component.id].start(a.nodeInterface.id):this.media[a.component.id].start()}};ContextPlayer.prototype.stop=function(a){if(!this.isStopped){this.isPlaying=!1;this.isStopped=!0;for(i in this.context)this.context[i].stop();for(i in this.media)this.media[i].stop();this.pausedMediaList=[];this.pausedContextList=[];$(this.htmlPlayer).trigger("presentation.onEnd",[a])}};
ContextPlayer.prototype.pause=function(a){if(this.isPlaying){this.isStopped=this.isPlaying=!1;for(i in this.context)this.context[i].isPlaying&&(this.pausedContextList.push(i),this.context[i].pause());for(i in this.media)this.media[i].isPlaying&&(this.pausedMediaList.push(i),this.media[i].pause());$(this.htmlPlayer).trigger("presentation.onPause",[a])}};
ContextPlayer.prototype.resume=function(a){if(!this.isPlaying&&!this.isStopped){this.isPlaying=!0;this.isStopped=!1;for(i in this.pausedContextList)this.context[this.pausedContextList[i]].resume();for(i in this.pausedMediaList)this.media[this.pausedMediaList[i]].resume();this.pausedContextList=[];this.pausedMediaList=[];$(this.htmlPlayer).trigger("presentation.onResume",[a])}};
ContextPlayer.prototype.abort=function(a){if(!this.isStopped){this.isPlaying=!1;this.isStopped=!0;for(i in this.context)this.context[i].abort();for(i in this.media)this.media[i].abort();this.pausedMediaList=[];this.pausedContextList=[];$(this.htmlPlayer).trigger("presentation.onAbort",[a])}};ContextPlayer.isVariable=function(a){return"$"==a.substring(0,1)};
ContextPlayer.createLocalParamMap=function(a){var b={};for(i in a)currentBindParam=a[i],b["$"+currentBindParam.name.name]=currentBindParam.value;return b};ContextPlayer.executeTriggerArray=function(a){for(var b;void 0!=(b=a.shift());)$(b[0]).trigger(b[1],b[2])};
ContextPlayer.prototype.bindLinks=function(){var a=this.node.port,b=this.node.link,c=this.handlers,d;for(d in a){var e=a[d],f=e.nodeInterface?e.nodeInterface._type:void 0;if("media"==e.component._type&&f)console.warn("Eventos de atribuicao para propriedades referenciadas por portas nao foi implementado");else{var f="#"+this.presentation.getDivId(e.component.id),e=e.id,g;for(g in Parser.eventType){var j=Parser.eventType[g];if("attribution"!=j){var h=[j,g].join(".");$(f).on(h,{contextElement:this.htmlPlayer,
interfaceId:e,eventName:h},function(a){$(a.data.contextElement).trigger(a.data.eventName,[a.data.interfaceId])})}}}}for(d in b){var a=b[d],h=a.xconnector,f={},e={},n=0,j="par",k=h.simpleCondition,p={},q={},l=[];if(h.connectorParam)for(d in h.connectorParam)currentConnectorParam=h.connectorParam[d],p["$"+currentConnectorParam.name]="";if(h.compoundCondition)for(d in k=h.compoundCondition[0].simpleCondition,1<k.length&&(n=Listener.listenerType[h.compoundCondition[0].operator.toUpperCase()]),h.compoundCondition[0].assessmentStatement){var m=
h.compoundCondition[0].assessmentStatement[d];for(g in m.attributeAssessment){var o=m.attributeAssessment[g];"attribution"==o.eventType&&(!o.attributeType||"nodeProperty"==o.attributeType?q[o.role]={bindComponent:"",bindInterface:"",operator:m.comparator,value:m.valueAssessment.value,variable:ContextPlayer.isVariable(m.valueAssessment.value)}:console.warn("Eventos de tipos diferentes de attribution nao foram implementados para elementos do tipo AttributeAssessment"))}}for(g in q)l.push(q[g]);for(d in k)e[k[d].role]=
{bindComponent:"",bindInterface:null,eventType:Parser.eventType[k[d].role],flag:!1};k=h.simpleAction;h.compoundAction&&(j=h.compoundAction[0].operator.toLowerCase(),k=h.compoundAction[0].simpleAction);for(d in k)h=k[d],"set"==h.role?(m=!1,o="",h.value&&(ContextPlayer.isVariable(h.value)&&(m=!0),o=h.value),f[h.role]={binds:[],qualifier:k[d].qualifier,actionUseVariable:m,actionDefaultValue:o}):f[h.role]={binds:[],qualifier:k[d].qualifier};n=new Listener(n,j,f,e,l);if(a.linkParam)for(d in a.linkParam)currentLinkParam=
a.linkParam[d],p[currentLinkParam.name]=currentLinkParam.value;for(d in a.bind)l=a.bind[d],k=l.component.id,j="#"+this.presentation.getDivId(k),m=l.nodeInterface?l.nodeInterface.id||l.nodeInterface.name:void 0,f[l.role]?(k=null,h=f[l.role],"set"==l.role&&(h.actionUseVariable?(localParamMap=ContextPlayer.createLocalParamMap(l.bindParam),k=localParamMap[h.actionDefaultValue]?localParamMap[h.actionDefaultValue]:p[h.actionDefaultValue]):k=h.actionDefaultValue),h.binds.push({bindComponent:j,bindInterface:m,
value:k})):e[l.role]?(e[l.role].bindComponent=j,e[l.role].bindInterface=m,m=j,j=Parser.eventType[l.role],h=l.role,j=[j,h].join("."),l=[k,j].join("."),k=j+".triggerArray",c[l]||(c[l]=!0,$(m).data(k)||$(m).data(k,[]),$(m).data(j)||$(m).data(j,[]),$(m).on(j,{componentDivId:m,bindName:j,eventName:h,triggerArrayName:k},function(a,b){var c=$(a.data.componentDivId).data(a.data.bindName),d;for(d in c){var e=c[d];b==e.flagMap[a.data.eventName].bindInterface&&e.notifyEvent(a.data.eventName)}ContextPlayer.executeTriggerArray($(a.data.componentDivId).data(a.data.triggerArrayName))})),
n.triggerBuffer=$(m).data(k),$(m).data(j).push(n)):(currentAssessment=q[l.role],currentAssessment.bindComponent=j,currentAssessment.bindInterface=m,currentAssessment.variable&&(localParamMap=ContextPlayer.createLocalParamMap(l.bindParam),currentAssessment.value=localParamMap[currentAssessment.value]?localParamMap[currentAssessment.value]:p[currentAssessment.value]))}};var Debugger={WARN_INVALID_ATTR:100,WARN_INVALID_TAG:101,WARN_INVALID_HEAD_STRUCTURE:102,WARN_INVALID_REGION_DIMENSIONS:103,WARN_DUPLICATED_ZINDEX:104,WARN_NOT_IMPLEMENTED_YET:105,ERR_MISSING_ATTR:201,ERR_MISSING_ATTR_ONEOF:202,ERR_MISSING_ATTR_DEP:203,ERR_TOO_MANY_ATTRS:204,ERR_MISSING_TAG:205,ERR_MISSING_TAG_ONEOF:206,ERR_TOO_MANY_TAGS:207,ERR_TOO_MANY_TAGS_ONEOF:208,ERR_INVALID_ATTR_VALUE:209,ERR_INVALID_ID_REFERENCE:210,ERR_DUPLICATED_ID:211,ERR_INCOMPATIBLE_FILE_EXT:212,ERR_INVALID_URI:213,ERR_DUPLICATED_ATTR:214,
ERR_DUPLICATED_ALIAS:215,ERR_INVALID_CONTEXT_REFERENCE:216,MESSAGES:{100:"Atributo inv\ufffdlido",101:"Tag inv\ufffdlida",102:"Estrutura do cabe\ufffdalho inv\ufffdlida",103:"Dimens\ufffdes de regi\ufffdo inv\ufffdlidas",104:"zIndex duplicado",105:"Recurso n\ufffdo implementado ainda",201:"Atributo obrigat\ufffdrio faltando",202:"Atributo obrigat\ufffdrio faltando (um desses)",203:"Atributo dependente faltando",204:"Excesso de atributos repetidos",205:"Tag obrigat\ufffdria faltando",206:"Tag obrigat\ufffdria faltando (uma dessas)",
207:"Excesso de tags repetidas",208:"Excesso de tags (apenas uma permitida)",209:"Valor de atributo inv\ufffdlido",210:"Refer\ufffdncia a ID inv\ufffdlido",211:"ID duplicado",212:"Extens\ufffdo de arquivo incompat\ufffdvel com o MIMETYPE",213:"URI inv\ufffdlida",214:"Atributo duplicado",215:"Alias duplicado",216:"Objeto referenciado em outro contexto"},abort:!1,refTable:{table:[],push:function(a,b,c,d){if(this.table[a])if("property"==b||"connectorParam"==b){if(this.table[a][d])return!1}else return!1;
else this.table[a]=[];this.table[a][d]={type:b,obj:c};return!0},pop:function(a,b){if(b)return this.table[a][b];for(parent in this.table[a])return this.table[a][parent];return!1}},uniqueTable:[],checkAll:function(a,b,c,d){this.checkAttributes(a,b,d);this.checkChildrenTags(a,c)},checkFile:function(a){$.ajax({type:"GET",url:a,dataType:"txt",success:function(a){console.log("NCL lines: "+a.split("\n").length)}})},checkAttributes:function(a,b,c){for(var d=$(a).get(0).attributes,e=$(a).get(0).tagName,f=
[],g=0;g<d.length;g++)f.push(d.item(g).name);for(attr in b.reference)$(a).attr(b.reference[attr])&&(d="focusIndex"==b.reference[attr]?"focusIndex":e,this.refTable.push($(a).attr(b.reference[attr]),d,c,$(a).parent().attr("id"))||this.error(this.ERR_DUPLICATED_ID,e,[b.reference[attr],$(a).attr(b.reference[attr]),$(a).parent().attr("id")]));for(attr in b.required)if(a=f.indexOf(b.required[attr]),-1==a)this.error(this.ERR_MISSING_ATTR,e,[b.required[attr]]);else for(f[a]=0;a=-1!=f.indexOf(b.required[attr]);)this.error(this.ERR_TOO_MANY_ATTRS,
e,[b.required[attr]]),f[a]=0;for(attr in b.optional)if(a=f.indexOf(b.optional[attr]),-1!=a)for(f[a]=0;a=-1!=f.indexOf(b.required[attr]);)this.error(this.ERR_TOO_MANY_ATTRS,e,[b.required[attr]]),f[a]=0;c=0==b.oneOf.length;for(attr in b.oneOf)if(a=f.indexOf(b.oneOf[attr]),-1!=a){c=!0;for(f[a]=0;a=-1!=f.indexOf(b.oneOf[attr]);)this.error(this.ERR_TOO_MANY_ATTRS,e,[b.oneOf[attr]]),f[a]=0}c||this.error(this.ERR_MISSING_ATTR_ONEOF,e,b.oneOf);for(attr in f)0!=f[attr]&&this.warning(this.WARN_INVALID_ATTR,
e,[f[attr]])},checkChildrenTags:function(a,b){var c=$(a).get(0).tagName,d=[],e=[],e=e.concat(b.one,b.optional,b.plus,b.plusOneOf,b.star,b.custom),f;for(f in e)d[e[f]]=0;$(a).find("> *").each(function(){var a=$(this).get(0).tagName;d[a]?d[a]++:d[a]=1});for(f in b.optional)1<d[b.optional[f]]&&this.error(this.ERR_TOO_MANY_TAGS,c,[b.optional[f]]),d[b.optional[f]]=0;for(f in b.one)1<d[b.one[f]]&&this.error(this.ERR_TOO_MANY_TAGS,c,[b.one[f]]),0==d[b.one[f]]&&this.error(this.ERR_MISSING_TAG,c,[b.one[f]]),
d[b.one[f]]=0;for(f in b.plus)0==d[b.plus[f]]&&this.error(this.ERR_MISSING_TAG,c,[b.plus[f]]),d[b.plus[f]]=0;e=0==b.plusOneOf.length;for(f in b.plusOneOf)0<d[b.plusOneOf[f]]&&(e=!0),d[b.plusOneOf[f]]=0;e||this.error(this.ERR_MISSING_TAG_ONEOF,c,b.plusOneOf);for(f in b.star)d[b.star[f]]=0;if(0<b.custom.length){b.validate(d,errors=[]);for(err in errors)this.error(errors[err].code,c,errors[err].params);for(f in b.custom)d[b.custom[f]]=0}for(f in d)0<d[f]&&this.warning(this.WARN_INVALID_TAG,c,[f])},error:function(a,
b,c){console.error("["+a+"] "+this.MESSAGES[a]+"\n"+b+": "+c.join(","));this.abort=!0},warning:function(a,b,c){console.warn("["+a+"] "+this.MESSAGES[a]+"\n"+b+": "+c.join(","))},debugTag:function(a,b,c,d){if("ncl"==a)this.debugNCL(b,a,c,d);else this["debug"+a[0].toUpperCase()+a.slice(1,a.length)](b,a,c,d)},debugNCL:debugNCL,debugArea:debugArea,debugAssessmentStatement:debugAssessmentStatement,debugAttributeAssessment:debugAttributeAssessment,debugBind:debugBind,debugBindParam:debugBindParam,debugBindRule:debugBindRule,
debugBody:debugBody,debugCausalConnector:debugCausalConnector,debugCompositeRule:debugCompositeRule,debugCompoundAction:debugCompoundAction,debugCompoundCondition:debugCompoundCondition,debugCompoundStatement:debugCompoundStatement,debugConnectorBase:debugConnectorBase,debugConnectorParam:debugConnectorParam,debugContext:debugContext,debugDefaultComponent:debugDefaultComponent,debugDefaultDescriptor:debugDefaultDescriptor,debugDescriptor:debugDescriptor,debugDescriptorBase:debugDescriptorBase,debugDescriptorParam:debugDescriptorParam,
debugDescriptorSwitch:debugDescriptorSwitch,debugHead:debugHead,debugImportBase:debugImportBase,debugImportedDocumentBase:debugImportedDocumentBase,debugImportNCL:debugImportNCL,debugLink:debugLink,debugLinkParam:debugLinkParam,debugMapping:debugMapping,debugMedia:debugMedia,debugMeta:debugMeta,debugMetadata:debugMetadata,debugPort:debugPort,debugProperty:debugProperty,debugRegion:debugRegion,debugRegionBase:debugRegionBase,debugRule:debugRule,debugRuleBase:debugRuleBase,debugSimpleAction:debugSimpleAction,
debugSimpleCondition:debugSimpleCondition,debugSwitch:debugSwitch,debugSwitchPort:debugSwitchPort,debugTransition:debugTransition,debugTransitionBase:debugTransitionBase,debugValueAssessment:debugValueAssessment};function FocusManager(a){var a=a.ncl.head.descriptorBase.descriptor,b=[],c;for(c in a){var d=a[c];d.focusIndex&&(b.push(d.focusIndex),this.descriptors[d.focusIndex]={self:d,mediaArray:[]})}this.bindKeyDown()}
FocusManager.prototype.addMedia=function(a,b){if(a in this.descriptors){var c=this.descriptors[a];-1==c.mediaArray.indexOf(b)&&(c.mediaArray.push(b),this.bindMouseEvents(a,b));a in this.focusIndexArray||this.focusIndexArray.push(a);this.currentFocusIndex?this.currentFocusIndex==a&&this.setMediaFocus(b):this.setCurrentFocus(a)}};
FocusManager.prototype.removeMedia=function(a,b){if(a in this.descriptors){var c=this.descriptors[a],d=c.mediaArray.indexOf(b);-1!=d&&(c.mediaArray.splice(d,1),this.unbindMouseEvents(b));a==this.currentFocusIndex&&0==c.mediaArray.length&&(this.focusIndexArray.splice(this.focusIndexArray.indexOf(a),1),0==this.focusIndexArray.length?this.setCurrentFocus(void 0):(this.focusIndexArray.sort(this.sortFunction),this.setCurrentFocus(this.focusIndexArray[0])))}};
FocusManager.prototype.setCurrentFocus=function(a){if(void 0==a)this.currentFocusIndex=a;else if(-1!=this.focusIndexArray.indexOf(a)){if(this.currentFocusIndex){var b=this.descriptors[this.currentFocusIndex],c;for(c in b.mediaArray){var d=currentDescriptor.mediaArray[c];this.removeMediaFocus(d)}}currentDescriptor=this.descriptors[a];for(c in currentDescriptor.mediaArray)d=currentDescriptor.mediaArray[c],this.setMediaFocus(d);this.currentFocusIndex=a;return!0}return!1};
FocusManager.prototype.getCurrentFocus=function(){return this.currentFocusIndex};FocusManager.prototype.setMediaFocus=function(a){$(a).trigger("focus")};FocusManager.prototype.removeMediaFocus=function(a){$(a).trigger("blur")};FocusManager.prototype.bindKeyDown=function(){$(window).on("keydown",$.proxy(function(a){-1!=Keys.allCodes.indexOf(a.which)&&(a.preventDefault(),this.keyEvent(a.which))},this))};FocusManager.prototype.unbindKeyDown=function(){$(window).off("keydown")};
FocusManager.prototype.keyEvent=function(a){if(this.currentFocusIndex)switch(currentDescriptor=this.descriptors[this.currentFocusIndex],a){case Keys.CURSOR_UP:currentDescriptor.self.moveUp&&this.setCurrentFocus(currentDescriptor.self.moveUp.focusIndex);break;case Keys.CURSOR_DOWN:currentDescriptor.self.moveDown&&this.setCurrentFocus(currentDescriptor.self.moveDown.focusIndex);break;case Keys.CURSOR_LEFT:currentDescriptor.self.moveLeft&&this.setCurrentFocus(currentDescriptor.self.moveLeft.focusIndex);
break;case Keys.CURSOR_RIGHT:currentDescriptor.self.moveRight&&this.setCurrentFocus(currentDescriptor.self.moveRight.focusIndex);break;case Keys.ENTER:for(var b in currentDescriptor.mediaArray)currentMedia=currentDescriptor.mediaArray[b],$(currentMedia).trigger("selection.onSelection")}};
FocusManager.prototype.bindMouseEvents=function(a,b){$(b).css("cursor","pointer");$(b).on("click",$.proxy(function(a){1==a.which&&this.keyEvent(Keys.ENTER)},this));$(b).on("mouseover",{focusIndex:a},$.proxy(function(a){this.setCurrentFocus(a.data.focusIndex)},this))};FocusManager.prototype.unbindMouseEvents=function(a){$(a).off("click");$(a).off("mouseover");$(a).css("cursor","default")};FocusManager.prototype.currentFocusIndex=void 0;FocusManager.prototype.descriptors={};
FocusManager.prototype.focusIndexArray=[];FocusManager.sortFunction=function(a,b){a=(""+a).toLowerCase();b=(""+b).toLowerCase();return a>b?1:a<b?-1:0};Keys={allCodes:[13,37,38,39,40],CURSOR_UP:38,CURSOR_DOWN:40,CURSOR_LEFT:37,CURSOR_RIGHT:39,ENTER:13};function Listener(a,b,c,d,e){this.listenerType=a;this.actionOperator=b;this.actionMap=c;this.flagMap=d;this.assessmentStatements=e;this.last=new Date;this.triggerBuffer=void 0;this.actionNamesArray=[];for(actionName in c)this.actionNamesArray.push(actionName)}
Listener.prototype.notifyEvent=function(a){switch(this.listenerType){case Listener.listenerType.SIMPLE:this.__verifyAssessmentStatements()&&this.__executeActions();break;case Listener.listenerType.AND:if((new Date).valueOf()-this.last.valueOf()>presentation.TIME_LIMIT){for(var b in this.flagMap)this.flagMap[b].flag=!1;this.flagMap[a].flag=!0;this.last=new Date}else{a=this.flagMap[a].flag=!0;for(b in this.flagMap)if(!this.flagMap[b].flag){a=!1;break}if(a){for(b in this.flagMap)this.flagMap[b].flag=
!1;this.last=0;this.__verifyAssessmentStatements()&&this.__executeActions()}}break;case NclPlayer.listenerType.OR:(new Date).valueOf()-this.last.valueOf()>presentation.TIME_LIMIT&&(this.last=new Date,this.__executeActions())}};
Listener.prototype.__verifyAssessmentStatements=function(){for(var a in this.assessmentStatements){var b=this.assessmentStatements[a],c=$(b.bindComponent).data("property")[b.bindInterface];switch(b.operator){case "eq":if(c!=b.value)return!1;break;case "ne":if(c==b.value)return!1;break;case "lt":if(!(c<b.value))return!1;break;case "lte":if(!(c<=b.value))return!1;break;case "gt":if(!(c>b.value))return!1;break;case "gte":if(!(c>=b.value))return!1}}return!0};
Listener.prototype.__executeActions=function(){"seq"==this.actionOperator?this.__executeActionsSeq([0]):this.__executeActionsPar()};Listener.prototype.__executeActionsSeq=function(a){a=a[0];a<this.actionNamesArray.length&&this.__callTriggers([this.actionNamesArray[a],a])};Listener.prototype.__executeActionsPar=function(){for(var a in this.actionMap)this.__callTriggers([a,-1])};
Listener.prototype.__callTriggers=function(a){var b=a[0],a=a[1];"seq"==this.actionMap[b].qualifier?this.__callTriggersSeq([b,a,0]):this.__callTriggersPar([b,a])};
Listener.prototype.__callTriggersSeq=function(a){var b=a[0],c=a[1],a=a[2],d=this.actionMap[b].binds,e=d[a];0<=c?0==a&&0==c?a==d.length-1?this.triggerBuffer.push([e.bindComponent,b,[e.bindInterface,$.proxy(this.__executeActionsSeq,this),[c+1],e.value]]):this.triggerBuffer.push([e.bindComponent,b,[e.bindInterface,$.proxy(this.__callTriggersSeq,this),[b,c,a+1],e.value]]):a<d.length-1?$(e.bindComponent).trigger(b,[e.bindInterface,$.proxy(this.__callTriggersSeq,this),[b,c,a+1],e.value]):$(e.bindComponent).trigger(b,
[e.bindInterface,$.proxy(this.__executeActionsSeq,this),[c+1],e.value]):0==a?a==d.length-1?this.triggerBuffer.push([e.bindComponent,b,[e.bindInterface,null,null,e.value]]):this.triggerBuffer.push([e.bindComponent,b,[e.bindInterface,$.proxy(this.__callTriggersSeq,this),[b,c,a+1],e.value]]):a<d.length-1?$(e.bindComponent).trigger(b,[e.bindInterface,$.proxy(this.__callTriggersSeq,this),[b,c,a+1],e.value]):$(e.bindComponent).trigger(b,[e.bindInterface,null,null,e.value])};
Listener.prototype.__callTriggersPar=function(a){var b=a[0],a=a[1],c=this.actionMap[b],d,e;for(e in c.binds)d=c.binds[e],e==c.binds.length-1&&0<=a?0==a?this.triggerBuffer.push([d.bindComponent,b,[d.bindInterface,$.proxy(this.__executeActionsSeq,this),[a+1],d.value]]):$(d.bindComponent).trigger(b,[d.bindInterface,$.proxy(this.__executeActionsSeq,this),[a+1],d.value]):0>=a?this.triggerBuffer.push([d.bindComponent,b,[d.bindInterface,null,null,d.value]]):$(d.bindComponent).trigger(b,[d.bindInterface,
null,null,d.value])};Listener.listenerType={SIMPLE:0,AND:1,OR:2};MediaPlayer.prototype=new Player;function MediaPlayer(a,b){this.htmlPlayerBkg=this.htmlPlayer=this.type=this.region="";this.popcornPlayer={};this.area=[];this.transIn=[];this.transOut=[];this.isPlaying=!1;this.isVisible=this.isStopped=!0;this.isFocused=!1;this.opacity=1;this.node=a;this.presentation=b.presentation;this.parentContext=b;this.create(a)}MediaPlayer.prototype.checkType=function(a){var b=this.type.split("/"),c;for(c in a){var d=a[c].split("/");if(d[0]==b[0]&&(!d[1]||b[1]&&d[1]==b[1]))return!0}return!1};
MediaPlayer.prototype.create=function(a){a.descriptor&&(this.transIn=a.descriptor.transIn,this.transOut=a.descriptor.transOut);for(i in a.area)this.area[a.area[i].id]=a.area[i],a.area[i].begin&&(this.area[a.area[i].id].beginTime=parseInt(a.area[i].begin.split("s")[0])),a.area[i].end&&(this.area[a.area[i].id].endTime=parseInt(a.area[i].end.split("s")[0]));if(a.type)this.type=a.type;else{var b=a.src.split(".");this.type=Parser.mediaTypes[b[b.length-1]]}this.htmlPlayer="#"+this.presentation.getDivId(a.id);
this.htmlPlayerBkg="#"+this.presentation.getDivId(a.id,"bkg");this.region=this.checkType(["application"])?"#"+this.presentation.settingsDiv:"#"+this.presentation.playerDiv;$(this.region).append("<div class='playerBkg' id='"+this.presentation.getDivId(a.id,"bkg")+"'></div>");switch(this.type.split("/")[0]){case "video":$(this.htmlPlayerBkg).append("<video class='player' poster='images/loading.gif' id='"+this.presentation.getDivId(a.id)+"'></video>");break;case "audio":$(this.htmlPlayerBkg).append("<audio class='player' id='"+
this.presentation.getDivId(a.id)+"'></audio>");break;case "image":$(this.htmlPlayerBkg).append("<img class='player' id='"+this.presentation.getDivId(a.id)+"'></img>");break;case "application":switch(this.type){case "application/x-ginga-settings":$(this.htmlPlayerBkg).append("<div class='player' id='"+this.presentation.getDivId(a.id)+"'></div>");break;case "application/x-ginga-NCLua":Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"media",[this.type]);break;case "application/x-ginga-NCLet":Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,
"media",[this.type]);break;case "application/x-ginga-time":Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"media",[this.type])}break;case "text":switch(this.type){case "text/plain":case "text/html":$(this.htmlPlayerBkg).append("<div class='player' id='"+this.presentation.getDivId(a.id)+"'></div>");break;case "text/css":Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"media",[this.type]);break;case "text/xml":Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"media",[this.type])}}$(this.htmlPlayerBkg).css("display",
"none");this.load(a.src);if(this.checkType(["video","audio"])){do this.popcornPlayer=new Popcorn(this.htmlPlayer);while(!this.popcornPlayer);$(this.htmlPlayer).on("ended",$.proxy(function(){this.stop()},this));for(i in this.area)this.area[i].end&&eval("this.popcornPlayer.exec(this.area[i].endTime,$.proxy(function() {$(this.htmlPlayer).trigger('stop',[this.area['"+i+"'].id]);},this));"),this.area[i].begin&&eval("this.popcornPlayer.exec(this.area[i].beginTime,$.proxy(function() {$(this.htmlPlayer).trigger('presentation.onBegin',[this.area['"+
i+"'].id]);},this));")}$(this.htmlPlayer).data("property",[]);if(a.descriptor)for(i in a.descriptor.region&&(this.setProperty("zIndex",a.descriptor.region.zIndex),this.setProperty("width",a.descriptor.region.width),this.setProperty("height",a.descriptor.region.height),this.setProperty("bottom",a.descriptor.region.bottom),this.setProperty("top",a.descriptor.region.top),this.setProperty("right",a.descriptor.region.right),this.setProperty("left",a.descriptor.region.left),this.setProperty("title",a.descriptor.region.title)),
a.descriptor.descriptorParam)this.setProperty(a.descriptor.descriptorParam[i].name,a.descriptor.descriptorParam[i].value);for(i in a.property)this.setProperty(a.property[i].name,a.property[i].value);this.bindEvents();$(this.htmlPlayer).data("player",this)};
MediaPlayer.prototype.load=function(a){$(this.htmlPlayer).empty();a="data/"+a;switch(this.type.split("/")[0]){case "video":$(this.htmlPlayer).append("<source src='"+a+"'></source>");break;case "audio":$(this.htmlPlayer).append("<source src='"+a+"'></source>");break;case "image":$(this.htmlPlayer).attr("src",a);break;case "text":this.checkType(["text/plain","text/html"])&&$.ajax({type:"GET",url:a,dataType:"text",success:$.proxy(function(a){$(this.htmlPlayer).append(a)},this)})}};
MediaPlayer.prototype.focus=function(){if(!this.isFocused&&(this.isFocused=!0,this.node.descriptor)){var a=parseInt(this.node.descriptor.focusBorderWidth||this.presentation.systemSettings.getPropertyValue("default.focusBorderWidth"));if(0<a){var b=this.node.descriptor.focusBorderColor||this.presentation.systemSettings.getPropertyValue("default.focusBorderColor"),c=1-parseInt(this.node.descriptor.focusBorderTransparency||0),b=a+"px solid rgba("+Parser.colorValues[b]+","+c+")";$(this.htmlPlayerBkg).css("left",
"-="+a);$(this.htmlPlayerBkg).css("top","-="+a);$(this.htmlPlayerBkg).css("border",b)}else 0>a&&Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"border",[a]);this.node.descriptor.focusSrc&&this.load(this.node.descriptor.focusSrc)}};
MediaPlayer.prototype.blur=function(){this.isFocused=!1;$(this.htmlPlayerBkg).css("left",$(this.htmlPlayer).data("property").left);$(this.htmlPlayerBkg).css("top",$(this.htmlPlayer).data("property").top);$(this.htmlPlayerBkg).css("width",$(this.htmlPlayer).data("property").width);$(this.htmlPlayerBkg).css("height",$(this.htmlPlayer).data("property").height);$(this.htmlPlayerBkg).css("border","none");this.node.descriptor.focusSrc&&this.load(this.node.src)};
MediaPlayer.prototype.selection=function(){if(this.node.descriptor){var a;a=this.node.descriptor.selBorderColor||this.presentation.systemSettings.getPropertyValue("default.selBorderColor");$(this.htmlPlayer).css("border-color",a);a="var p=$('"+this.htmlPlayer+"').data('player'); if (p.isFocused) p.focus(); else p.blur();";this.node.descriptor.focusSelSrc&&(this.load(this.node.descriptor.focusSelSrc),this.node.descriptor.focusSrc||(a+="$('"+this.htmlPlayer+"').data('player').load('"+this.node.src+
"');"));setTimeout(a,200)}};
MediaPlayer.prototype.applyTransition=function(a,b){var c=a.dur?1E3*parseInt(a.dur.split("s")[0]):1E3,d={},e={},f="";switch(a.type){case "fade":a.subtype=a.subtype||"crossfade";f=this.htmlPlayer;d.opacity=a.startProgress||0;e.opacity=a.endProgress||1;if("fadeToColor"==a.subtype||"fadeFromColor"==a.subtype)$(this.htmlPlayerBkg).css("background-color",a.fadeColor||"black"),b="fadeToColor"==a.subtype?"out":"in";if("out"==b){var g=d.opacity;d.opacity=e.opacity;e.opacity=g}this.opacity=e.opacity;break;
case "barWipe":a.subtype=a.subtype||"leftToRight";f=this.htmlPlayerBkg;g=1==("reverse"==a.direction?1:0)+("out"==b?1:0);switch(a.subtype){case "leftToRight":d.width="0px";e.width=$(this.htmlPlayer).css("width");g&&(d.left=parseInt($(this.htmlPlayer).css("left").split("px")[0])+parseInt($(this.htmlPlayer).css("width").split("px")[0])+"px",e.left=$(this.htmlPlayer).css("left"));break;case "topToBottom":d.height="0px",e.height=$(this.htmlPlayer).css("height"),g&&(d.top=parseInt($(this.htmlPlayer).css("top").split("px")[0])+
parseInt($(this.htmlPlayer).css("height").split("px")[0])+"px",e.top=$(this.htmlPlayer).css("top"))}if("out"==b)for(i in d)g=d[i],d[i]=e[i],e[i]=g;break;case "irisWipe":a.subtype=a.subtype||"rectangle";f=this.htmlPlayerBkg;if("rectangle"==a.subtype){var g=parseInt($(this.htmlPlayer).css("left").split("px")[0]),j=parseInt($(this.htmlPlayer).css("top").split("px")[0]),h=parseInt($(this.htmlPlayer).css("width").split("px")[0]),n=parseInt($(this.htmlPlayer).css("height").split("px")[0]);d.width="0px";
d.height="0px";d.left=g+h/2+"px";d.top=j+n/2+"px";e.width=h+"px";e.height=n+"px";e.left=g+"px";e.top=j+"px";if("out"==b)for(i in d)g=d[i],d[i]=e[i],e[i]=g}else Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"transition",[a.type,a.subtype]);break;case "snakeWipe":case "clockWipe":Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"transition",[a.type])}$(f).css(d);$(f).animate(e,c);$(f).dequeue()};
MediaPlayer.prototype.show=function(){if(this.isVisible){for(i in this.transIn)this.applyTransition(this.transIn[i],"in");$(this.htmlPlayerBkg).css("display","inline");$(this.htmlPlayer).css("opacity",this.opacity)}};MediaPlayer.prototype.hide=function(){for(i in this.transOut)this.applyTransition(this.transOut[i],"out");$(this.htmlPlayerBkg).css("display","none")};
MediaPlayer.prototype.start=function(a){this.isStopped&&(this.presentation.focusManager.addMedia(this.node.descriptor.focusIndex,this.htmlPlayer),this.isPlaying=!0,this.isStopped=!1,this.show(),this.checkType(["audio","video"])&&(this.parentContext.syncPlayer(this),a&&"area"==this.area[a]._type?this.area[this.area[a].id].begin&&(this.seek(this.area[this.area[a].id].beginTime),$(this.htmlPlayer).one("seeked",$.proxy(function(){this.parentContext.notify(this)},this))):this.parentContext.notify(this)),
$(this.htmlPlayer).trigger("presentation.onBegin",[a]))};MediaPlayer.prototype.stop=function(a){this.isStopped||(this.presentation.focusManager.removeMedia(this.node.descriptor.focusIndex,this.htmlPlayer),this.isPlaying=!1,this.isStopped=!0,this.hide(),this.checkType(["video","audio"])&&this.popcornPlayer.pause(),$(this.htmlPlayer).trigger("presentation.onEnd",[a]))};
MediaPlayer.prototype.pause=function(a){this.isPlaying&&(this.isStopped=this.isPlaying=!1,this.checkType(["video","audio"])&&this.popcornPlayer.pause(),$(this.htmlPlayer).trigger("presentation.onPause",[a]))};MediaPlayer.prototype.resume=function(a){!this.isStopped&&!this.isPlaying&&(this.isPlaying=!0,this.isStopped=!1,this.checkType(["video","audio"])&&this.popcornPlayer.play(),$(this.htmlPlayer).trigger("presentation.onResume",[a]))};
MediaPlayer.prototype.abort=function(a){this.isStopped||(this.presentation.focusManager.removeMedia(this.node.descriptor.focusIndex,this.htmlPlayer),this.isPlaying=!1,this.isStopped=!0,this.hide(),this.checkType(["video","audio"])&&this.popcornPlayer.pause(),$(this.htmlPlayer).trigger("presentation.onAbort",[a]))};
MediaPlayer.prototype.seek=function(a){try{this.popcornPlayer.currentTime(a)}catch(b){eval("$(this.htmlPlayer).one('loadedmetadata',$.proxy(function() {this.popcornPlayer.currentTime("+a+");},this));")}};
MediaPlayer.prototype.seekAndPlay=function(a){if(!this.isStopped&&this.checkType(["video","audio"])){try{this.popcornPlayer.currentTime(a)}catch(b){eval("$(this.htmlPlayer).one('loadedmetadata',$.proxy(function() {this.popcornPlayer.currentTime("+a+");},this));")}$(this.htmlPlayer).one("seeked",$.proxy(function(){this.popcornPlayer.play()},this))}};function NclPlayer(a,b){this.presentation={TIME_LIMIT:1E3,playerId:++NclPlayer.playerCount,playerDiv:b,getDivId:function(a,b){return"ncl"+this.playerId+(b||"")+"_"+a}};this.presentation.bodyDiv="body"+this.presentation.playerId;this.presentation.settingsDiv="settings"+this.presentation.playerId;this.presentation.contextsDiv="contexts"+this.presentation.playerId;$.ajax({type:"GET",url:a,dataType:"xml",success:$.proxy(function(a){this.execute(a)},this)})}
NclPlayer.prototype.execute=function(a){this.presentation.ncl=Parser.parse(a);this.presentation.focusManager=new FocusManager(this.presentation);this.presentation.systemSettings=new SystemSettings(this.presentation);for(rb in this.presentation.ncl.head.regionBase)for(i in this.presentation.ncl.head.regionBase[rb].region)a={left:0,top:0,width:parseInt($("#"+this.presentation.playerDiv).css("width").split("px")[0]),height:parseInt($("#"+this.presentation.playerDiv).css("height").split("px")[0])},this.fixRegionBounds(this.presentation.ncl.head.regionBase[rb].region[i],
a);$("#"+this.presentation.playerDiv).append("<div id='"+this.presentation.settingsDiv+"'></div>");$("#"+this.presentation.playerDiv).append("<div id='"+this.presentation.contextsDiv+"'></div>");(new ContextPlayer(this.presentation.ncl.body,this.presentation)).start()};
NclPlayer.prototype.fixRegionBounds=function(a,b){var c={left:a.left||null,right:a.right||null,top:a.top||null,bottom:a.bottom||null,width:a.width||null,height:a.height||null},d={left:0,top:0,width:0,height:0};for(i in c)null!=c[i]&&(c[i]=parseInt(c[i].split("px")[0]));var e,f;e=["left","right","width"];for(i in e)null!=c[e[i]]&&isNaN(c[e[i]])&&(f=c[e[i]].split("%"),1<f.length&&(c[e[i]]=parseInt(b.width*parseFloat(f[0])/100)));e=["top","bottom","height"];for(i in e)null!=c[e[i]]&&isNaN(c[e[i]])&&
(f=c[e[i]].split("%"),1<f.length&&(c[e[i]]=parseInt(b.height*parseInt(f[0])/100)));null!=c.left?null!=c.right?null==c.width&&(c.width=b.width-c.left-c.right):null==c.width&&(c.width=b.width):null!=c.width?c.left=null!=c.right?b.width-c.right-c.width:0:null!=c.right?(c.left=0,c.width=b.width-c.right):(c.left=0,c.width=b.width);null!=c.top?null!=c.bottom?null==c.height&&(c.height=b.height-c.top-c.bottom):null==c.height&&(c.height=b.height):null!=c.height?c.top=null!=c.bottom?b.height-c.bottom-c.height:
0:null!=c.bottom?(c.top=0,c.height=b.height-c.bottom):(c.top=0,c.height=b.height);d.left=b.left+c.left;d.top=b.top+c.top;d.width=c.width;d.height=c.height;a.left=d.left+"px";a.top=d.top+"px";a.width=d.width+"px";a.height=d.height+"px";a.right=null;a.bottom=null;for(i in a.region)this.fixRegionBounds(a.region[i],d)};NclPlayer.prototype.triggerEvent=function(a,b,c){$("#"+this.presentation.getDivId(b)).trigger(a,[c])};NclPlayer.playerCount=0;var Parser={eventType:{onBegin:"presentation",onEnd:"presentation",onAbort:"presentation",onPause:"presentation",onResume:"presentation",onSelection:"selection",onBeginAttribution:"attribution",onEndAttribution:"attribution"},mediaTypes:{htm:"text/htm",html:"text/html",txt:"text/plain",css:"text/css",xml:"text/xml",bmp:"image",png:"image",gif:"image",jpg:"image",jpeg:"image",wav:"audio",mp3:"audio",mp2:"audio",mp4:"video",mpg4:"video",mpeg:"video",mpg:"video",webm:"video",lua:"application/x-ginga-NCLua",
"class":"application/x-ginga-NCLet",jar:"application/x-ginga-NCLet"},colorValues:{white:"255,255,255",black:"0,0,0",silver:"192,192,192",gray:"128,128,128",red:"255,0,0",maroon:"128,0,0",fuchsia:"255,0,255",purple:"128,0,128",lime:"0,255,0",green:"0,128,0",yellow:"255,255,0",olive:"128,128,0",blue:"0,0,255",navy:"0,0,128",aqua:"0,255,255",teal:"0,128,128"},parseAttrs:function(a,b,c,d){var e=!0;if(a&&"string"!=typeof a){for(var f in a){var g=c;isNaN(f)&&(e=!1,g+=">"+b,a.id&&(g+="#"+a.id));this.parseAttrs(a[f],
e?b:f,g,a)}e||Debugger.debugTag(b,a,d,c)}},isNotArray:"ncl,head,body,importedDocumentBase,ruleBase,transitionBase,descriptorBase,connectorBase,defaultDescriptor,valueAssessment,defaultComponent".split(","),parse:function(a){a=Parser.createNode(a,"ncl");Parser.parseAttrs(a,"ncl");return a},createNode:function(a,b){var c=$(a).find("ncl"==b?"ncl":"> "+b);if(0==c.length)return!1;var d=[],e=Parser.nclStructureMap[b].attrs;e.required||(e.required=[]);e.optional||(e.optional=[]);e.oneOf||(e.oneOf=[]);var f=
[].concat(e.required,e.optional,e.oneOf),g=Parser.nclStructureMap[b].tags;g.optional||(g.optional=[]);g.one||(g.one=[]);g.plus||(g.plus=[]);g.plusOneOf||(g.plusOneOf=[]);g.star||(g.star=[]);g.custom||(g.custom=[]);var j=[].concat(g.optional,g.one,g.plus,g.plusOneOf,g.star,g.custom);$(c).each(function(){var a={};a._type=b;for(i in f)a["interface"!=f[i]?f[i]:"nodeInterface"]=$(this).attr(f[i]);for(i in j)a[j[i]]=Parser.createNode(this,j[i]);d.push(a);Debugger.checkAll(this,e,g,a)});return-1==$.inArray(b,
Parser.isNotArray)?d:d[0]},nclStructureMap:{area:{attrs:{reference:["id"],required:["id"],optional:"coords,begin,end,text,position,first,last,label".split(",")},tags:{}},assessmentStatement:{attrs:{required:["comparator"]},tags:{custom:["attributeAssessment","valueAssessment"],validate:function(a,b){var c=a.attributeAssessment,d=a.valueAssessment;0==c&&b.push({code:Debugger.ERR_MISSING_TAG,params:["attributeAssessment"]});2>c&&0==d&&b.push({code:Debugger.ERR_MISSING_TAG_ONEOF,params:["attributeAssessment",
"valueAssessment"]});2==c&&0<d&&b.push({code:Debugger.ERR_TOO_MANY_TAGS_ONEOF,params:["attributeAssessment","valueAssessment"]});2<c&&b.push({code:Debugger.ERR_TOO_MANY_TAGS,params:["attributeAssessment"]});1<d&&b.push({code:Debugger.ERR_TOO_MANY_TAGS,params:["valueAssessment"]})}}},attributeAssessment:{attrs:{required:["role","eventType","attributeType"],optional:["key","offset"]},tags:{}},bind:{attrs:{required:["role","component"],optional:["interface","descriptor"]},tags:{star:["bindParam"]}},
bindParam:{attrs:{required:["name","value"]},tags:{}},bindRule:{attrs:{required:["constituent","rule"]},tags:{}},body:{attrs:{reference:["id"],optional:["id"]},tags:{star:"port,property,media,context,switch,link".split(",")}},causalConnector:{attrs:{reference:["id"],required:["id"]},tags:{star:["connectorParam"],custom:["simpleCondition","compoundCondition","simpleAction","compoundAction"],validate:function(a,b){0==a.simpleCondition&&0==a.compoundCondition?b.push({code:Debugger.ERR_MISSING_TAG_ONEOF,
params:["simpleCondition","compoundCondition"]}):0<a.simpleCondition&&0<a.compoundCondition?b.push({code:Debugger.ERR_TOO_MANY_TAGS_ONEOF,params:["simpleCondition","compoundCondition"]}):1<a.simpleCondition?b.push({code:Debugger.ERR_TOO_MANY_TAGS,params:["simpleCondition"]}):1<a.compoundCondition&&b.push({code:Debugger.ERR_TOO_MANY_TAGS,params:["compoundCondition"]});0==a.simpleAction&&0==a.compoundAction?b.push({code:Debugger.ERR_MISSING_TAG_ONEOF,params:["simpleAction","compoundAction"]}):0<a.simpleAction&&
0<a.compoundAction?b.push({code:Debugger.ERR_TOO_MANY_TAGS_ONEOF,params:["simpleAction","compoundAction"]}):1<a.simpleAction?b.push({code:Debugger.ERR_TOO_MANY_TAGS,params:["simpleAction"]}):1<a.compoundAction&&b.push({code:Debugger.ERR_TOO_MANY_TAGS,params:["compoundAction"]})}}},compositeRule:{attrs:{required:["id","operator"]},tags:{plusOneOf:["rule","compositeRule"]}},compoundAction:{attrs:{required:["operator"],optional:["delay"]},tags:{plusOneOf:["simpleAction","compoundAction"]}},compoundCondition:{attrs:{required:["operator"],
optional:["delay"]},tags:{plusOneOf:["simpleCondition","compoundCondition"],star:["assessmentStatement","compoundStatement"]}},compoundStatement:{attrs:{required:["operator"],optional:["isNegated"]},tags:{plusOneOf:["assessmentStatement","compoundStatement"]}},connectorBase:{attrs:{optional:["id"]},tags:{star:["importBase","causalConnector"]}},connectorParam:{attrs:{reference:["name"],ref_group:!0,required:["name"],optional:["type"]},tags:{}},context:{attrs:{reference:["id"],required:["id"],optional:["refer"]},
tags:{star:"port,property,media,context,switch,link".split(",")}},defaultComponent:{attrs:{required:["component"]},tags:{}},defaultDescriptor:{attrs:{required:["descriptor"]},tags:{}},descriptor:{attrs:{reference:["id","focusIndex"],required:["id"],optional:"player,explicitDur,region,freeze,moveLeft,moveRight,moveUp,moveDown,focusIndex,focusBorderColor,focusBorderWidth,focusBorderTransparency,focusSrc,focusSelSrc,selBorderColor,transIn,transOut".split(",")},tags:{star:["descriptorParam"]}},descriptorBase:{attrs:{optional:["id"]},
tags:{plusOneOf:["importBase","descriptor","descriptorSwitch"]}},descriptorParam:{attrs:{required:["name","value"]},tags:{}},descriptorSwitch:{attrs:{required:["id"]},tags:{optional:["defaultDescriptor"],star:["bindRule","descriptor"]}},head:{attrs:{},tags:{optional:["importedDocumentBase","ruleBase","transitionBase","descriptorBase","connectorBase"],star:["regionBase","meta","metadata"]}},importBase:{attrs:{required:["alias","documentURI"],optional:["region"]},tags:{}},importedDocumentBase:{attrs:{optional:["id"]},
tags:{plus:["importNCL"]}},importNCL:{attrs:{required:["alias","documentURI"]},tags:{}},link:{attrs:{required:["xconnector"],optional:["id"]},tags:{plus:["bind"],star:["linkParam"]}},linkParam:{attrs:{required:["name","value"]},tags:{}},mapping:{attrs:{required:["component"],optional:["interface"]},tags:{}},media:{attrs:{reference:["id"],required:["id"],optional:["refer","instance","descriptor"],oneOf:["type","src"]},tags:{star:["area","property"]}},meta:{attrs:{required:["name","content"]},tags:{}},
metadata:{attrs:{},tags:{}},ncl:{attrs:{optional:["id","title","xmlns"]},tags:{optional:["head","body"]}},port:{attrs:{reference:["id"],required:["id","component"],optional:["interface"]},tags:{}},property:{attrs:{reference:["name"],ref_group:!0,required:["name"],optional:["value"]},tags:{}},region:{attrs:{reference:["id"],required:["id"],optional:"title,left,right,top,bottom,height,width,zIndex".split(",")},tags:{star:["region"]}},regionBase:{attrs:{optional:["id","device"]},tags:{plusOneOf:["importBase",
"region"]}},rule:{attrs:{required:["id","var","comparator","value"]},tags:{}},ruleBase:{attrs:{optional:["id"]},tags:{plusOneOf:["importBase","rule","compositeRule"]}},simpleAction:{attrs:{required:["role"],optional:"delay,eventType,actionType,value,min,max,qualifier,repeat,repeatDelay,duration,by".split(",")},tags:{}},simpleCondition:{attrs:{required:["role"],optional:"delay,eventType,key,transition,min,max,qualifier".split(",")},tags:{}},"switch":{attrs:{reference:["id"],required:["id"],optional:["refer"]},
tags:{optional:["defaultComponent"]}},switchPort:{attrs:{required:["id"]},tags:{plus:["mapping"]}},transition:{attrs:{reference:["id"],required:["id","type"],optional:"subtype,dur,startProgress,endProgress,direction,fadeColor,horRepeat,vertRepeat,borderWidth,borderColor".split(",")},tags:{}},transitionBase:{attrs:{optional:["id"]},tags:{plusOneOf:["importBase","transition"]}},valueAssessment:{attrs:{required:["value"]},tags:{}}}};function Player(){this.create=function(){};this.start=function(){};this.stop=function(){};this.pause=function(){};this.resume=function(){};this.abort=function(){};this.seekAndPlay=function(){};this.selection=function(){}}
Player.prototype.bindEvents=function(){$(this.htmlPlayer).on("start",$.proxy(function(a,b,c,d){this.start(b);c&&c(d)},this));$(this.htmlPlayer).on("stop",$.proxy(function(a,b,c,d){this.stop(b);c&&c(d)},this));$(this.htmlPlayer).on("pause",$.proxy(function(a,b,c,d){this.pause(b);c&&c(d)},this));$(this.htmlPlayer).on("resume",$.proxy(function(a,b,c,d){this.resume(b);c&&c(d)},this));$(this.htmlPlayer).on("abort",$.proxy(function(a,b,c,d){this.abort(b);c&&c(d)},this));$(this.htmlPlayer).on("set",$.proxy(function(a,
b,c,d,e){this.setProperty(b,e);c&&c(d)},this));$(this.htmlPlayer).on("focus",$.proxy(function(){this.focus()},this));$(this.htmlPlayer).on("blur",$.proxy(function(){this.blur()},this));$(this.htmlPlayer).on("selection.onSelection",$.proxy(function(){this.selection()},this))};
Player.prototype.setProperty=function(a,b){var c=$(this.htmlPlayer).data("property");c[a]=b?b:"";$(this.htmlPlayer).data("property",c);$(this.htmlPlayer).trigger("attribution.onBeginAttribution",[a]);if(null!=b)switch(a){case "top":case "left":case "bottom":case "right":$(this.htmlPlayerBkg).css(a,b);break;case "height":case "width":$(this.htmlPlayer).css(a,b);$(this.htmlPlayerBkg).css(a,b);break;case "location":b.split(",");this.setProperty("left",d[0]);this.setProperty("top",d[1]);break;case "size":b.split(",");
this.setProperty("width",d[0]);this.setProperty("height",d[1]);break;case "bounds":var d=b.split(",");this.setProperty("left",d[0]);this.setProperty("top",d[1]);this.setProperty("width",d[2]);this.setProperty("height",d[3]);break;case "zIndex":$(this.htmlPlayer).css("z-index",b);$(this.htmlPlayerBkg).css("z-index",b);break;case "soundLevel":this.checkType(["video","audio"])&&(c=b.split("%"),1<c.length&&(b=c[0]/100),this.popcornPlayer.volume(b));break;case "balanceLevel":case "bassLevel":case "trebleLevel":b.split("%");
Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"setProperty",[a]);break;case "background":$(this.htmlPlayerBkg).css("background-color",b);break;case "transparency":c=b.split("%");b=1<c.length?parseInt(c[0])/100:parseFloat(c[0]);this.opacity=1-b;$(this.htmlPlayer).css("opacity",this.opacity);break;case "visible":(this.isVisible="true"==b?!0:!1)?(this.presentation.focusManager.addMedia(this.node.descriptor.focusIndex,this.htmlPlayer),$(this.htmlPlayerBkg).css("display","inline")):(this.presentation.focusManager.removeMedia(this.node.descriptor.focusIndex,
this.htmlPlayer),$(this.htmlPlayerBkg).css("display","none"));break;case "scroll":Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"setProperty",[a]);break;case "fit":Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"setProperty",[a]);break;case "style":Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"setProperty",[a]);break;case "fontColor":$(this.htmlPlayer).css("color",b);break;case "fontFamily":$(this.htmlPlayer).css("font-family",b);break;case "fontStyle":$(this.htmlPlayer).css("font-style",
b);break;case "fontSize":$(this.htmlPlayer).css("font-size",b);break;case "fontVariant":$(this.htmlPlayer).css("font-variant",b);break;case "fontWeight":$(this.htmlPlayer).css("font-weight",b);break;case "explicitDur":case "baseDeviceRegion":case "deviceClass":case "plan":case "player":case "playerLife":case "reusePlayer":Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,"property",[a]);break;case "transInBorderColor":case "transInBorderWidth":case "transInDirection":case "transInDur":case "transInEndProgress":case "transInFadeColor":case "transInHorRepeat":case "transInStartProgress":case "transInSubtype":case "transInType":case "transInVertRepeat":case "transBorderColor":case "transOutBorderWidth":case "transOutDirection":case "transOutDur":case "transOutEndProgress":case "transOutFadeColor":case "transOutHorRepeat":case "transOutType":case "transOutStartProgress":case "transOutSubtype":case "transOutVertRepeat":Debugger.warning(Debugger.WARN_NOT_IMPLEMENTED_YET,
"property",[a]);break;case "service.currentFocus":case "default.focusBorderColor":case "default.selBorderColor":case "default.focusBorderWidth":case "default.focusBorderTransparency":this.checkType(["application"])&&this.presentation.systemSettings.setPropertyValue(a,b)}};function SystemSettings(a){this.settings={"default.focusBorderColor":"blue","default.selBorderColor":"yellow","default.focusBorderWidth":2,"default.focusBorderTransparency":0,"service.currentKeyMaster":""};this.setMap={"service.currentFocus":$.proxy(a.focusManager.setCurrentFocus,a.focusManager)};this.getMap={"service.currentFocus":$.proxy(a.focusManager.getCurrentFocus,a.focusManager)}}
SystemSettings.prototype.setPropertyValue=function(a,b){if(a in this.settings)this.settings[a]=b;else if(a in this.setMap)this.setMap[a](b);else return!1;return!0};SystemSettings.prototype.getPropertyValue=function(a){return a in this.settings?this.settings[a]:a in this.setMap?this.getMap[a]():""};function debugArea(a,b,c){values=["(n\ufffdmero inteiro)s"];patt=/^\d+s$/;null!=a.begin&&!patt.test(a.begin)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["begin",a.begin,values]);null!=a.end&&!patt.test(a.end)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["end",a.end,values]);"application/x-ginga-time"==c.type&&null==a.begin&&null==a.end&&Debugger.error(Debugger.ERR_MISSING_ATTR,b,["begin","end"]);values=["(n\ufffdmero inteiro)"];patt=/^\d+$/;null!=a.first&&!patt.test(a.first)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,
b,["first",a.first,values]);null!=a.last&&!patt.test(a.last)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["last",a.last,values])};function debugAssessmentStatement(a,b){values="eq,ne,gt,lt,gte,lte".split(",");null!=a.comparator&&-1==jQuery.inArray(a.comparator,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["comparator",a.comparator,values])};function debugAttributeAssessment(a,b,c,d){null!=a.role&&(c=d.split("causalConnector#")[1].split(">")[0],Debugger.uniqueTable["id#"+c]||(Debugger.uniqueTable["id#"+c]=[]),Debugger.uniqueTable["id#"+c][a.role]?Debugger.uniqueTable["id#"+c][a.role].duplicated||(Debugger.uniqueTable["id#"+c][a.role].duplicated=!0,Debugger.error(Debugger.ERR_DUPLICATED_ATTR,"role",[a.role,c,["simpleAction","simpleCondition","attributeAssessment"]])):Debugger.uniqueTable["id#"+c][a.role]={duplicated:!1});values=["selection",
"presentation","attribution"];null!=a.eventType&&-1==jQuery.inArray(a.eventType,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["eventType",a.eventType,values]);values="0-9,A-Z,*,#,MENU,INFO,GUIDE,CURSOR_DOWN,CURSOR_LEFT,CURSOR_RIGHT,CURSOR_UP,CHANNEL_DOWN,CHANNEL_UP,VOLUME_DOWN,VOLUME_UP,ENTER,RED,GREEN,YELLOW,BLUE,BACK,EXIT,POWER,REWIND,STOP,EJECT,PLAY,RECORD,PAUSE".split(",");patt=/^([0-9A-Z]|\*|#|MENU|INFO|GUIDE|CURSOR_DOWN|CURSOR_LEFT|CURSOR_RIGHT|CURSOR_UP|CHANNEL_DOWN|CHANNEL_UP|VOLUME_DOWN|VOLUME_UP|ENTER|RED|GREEN|YELLOW|BLUE|BACK|EXIT|POWER|REWIND|STOP|EJECT|PLAY|RECORD|PAUSE)$/;
null==a.key?"selection"==a.eventType&&Debugger.error(Debugger.ERR_MISSING_ATTR,b,["key"]):patt.test(a.key)||Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["key",a.key,values]);switch(a.eventType){case "selection":values=["occurences","state"];break;case "presentation":values=["occurences","state","repetitions"];break;case "attribution":values=["occurences","state","repetitions","nodeProperty"]}null!=a.attributeType&&-1==jQuery.inArray(a.attributeType,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,
b,["attributeType",a.attributeType,values])};function debugBind(a,b){if(null!=a.component){var c=Debugger.refTable.pop(a.component);if(!c||"context"!=c.type&&"media"!=c.type)Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["component",a.component,["context","media"]]);else{if(null!=a.nodeInterface){var d=Debugger.refTable.pop(a.nodeInterface);!d||"context"==c.type&&"port"!=d.type||"media"==c.type&&"area"!=d.type&&"property"!=d.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["nodeInterface",a.nodeInterface,"context"==c.type?["port"]:
["area","property"]]):a.nodeInterface=d.obj}a.component=c.obj}}null!=a.descriptor&&(c=Debugger.refTable.pop(a.descriptor),!c||"descriptor"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["descriptor",a.descriptor,["descriptor"]]):a.descriptor=c.obj)};function debugBindParam(a,b){if(null!=a.name){var c=Debugger.refTable.pop(a.name);!c||"connectorParam"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["name",a.name,["connectorParam"]]):a.name=c.obj}};function debugBindRule(a,b){if(null!=a.constituent){var c=Debugger.refTable.pop(a.constituent);!c||"media"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["constituent",a.constituent,["media"]]):a.constituent=c.obj}null!=a.rule&&(c=Debugger.refTable.pop(a.rule),!c||"rule"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["rule",a.rule,["rule"]]):a.rule=c.obj)};function debugBody(){};function debugCausalConnector(){};function debugCompositeRule(a,b){values=["and","or"];null!=a.operator&&-1==jQuery.inArray(a.operator,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["operator",a.operator,values])};function debugCompoundAction(a,b){values=["par","seq"];null!=a.operator&&-1==jQuery.inArray(a.operator,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["operator",a.operator,values])};function debugCompoundCondition(a,b){values=["and","or"];null!=a.operator&&-1==jQuery.inArray(a.operator,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["operator",a.operator,values]);values=["(n\ufffdmero inteiro positivo)s"];patt=/^\d+s$/;null!=a.delay&&!patt.test(a.delay)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["delay",a.delay,values])};function debugCompoundStatement(a,b){values=["or","and"];null!=a.operator&&-1==jQuery.inArray(a.operator,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["operator",a.operator,values]);values=["true","false"];null!=a.isNegated&&-1==jQuery.inArray(a.isNegated,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["isNegated",a.isNegated,values])};function debugConnectorBase(){};function debugConnectorParam(){};function debugContext(a,b){if(null!=a.refer){var c=Debugger.refTable.pop(a.refer);!c||"body"!=c.type&&"context"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["refer",a.refer,["body","context"]]):a.refer=c.obj}};function debugDefaultComponent(a,b){if(null!=a.component){var c=Debugger.refTable.pop(a.component);!c||"context"!=c.type&&"media"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["component",a.component,["context","media"]]):a.component=c.obj}};function debugDefaultDescriptor(a,b){if(null!=a.descriptor){var c=Debugger.refTable.pop(a.descriptor);!c||"descriptor"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["descriptor",a.descriptor,["descriptor"]]):a.descriptor=c.obj}};function debugDescriptorBase(){};function debugDescriptor(a,b){if(null!=a.region){var c=Debugger.refTable.pop(a.region);!c||"region"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["region",a.region,["region"]]):a.region=c.obj}null!=a.moveLeft&&(c=Debugger.refTable.pop(a.moveLeft),!c||"focusIndex"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["moveLeft",a.moveLeft,["focusIndex"]]):a.moveLeft=c.obj);null!=a.moveRight&&(c=Debugger.refTable.pop(a.moveRight),!c||"focusIndex"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,
b,["moveRight",a.moveRight,["focusIndex"]]):a.moveRight=c.obj);null!=a.moveUp&&(c=Debugger.refTable.pop(a.moveUp),!c||"focusIndex"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["moveUp",a.moveUp,["focusIndex"]]):a.moveUp=c.obj);null!=a.moveDown&&(c=Debugger.refTable.pop(a.moveDown),!c||"focusIndex"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["moveDown",a.moveDown,["focusIndex"]]):a.moveDown=c.obj);if(null!=a.transIn){var d=a.transIn.split(";"),e=[];for(id in d)c=Debugger.refTable.pop(d[id]),
!c||"transition"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["transIn",d[id],["transition"]]):e.push(c.obj);a.transIn=e}if(null!=a.transOut){d=a.transOut.split(";");e=[];for(id in d)c=Debugger.refTable.pop(d[id]),!c||"transition"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["transOut",d[id],["transition"]]):e.push(c.obj);a.transIn=e}values=["(n\ufffdmero inteiro)s"];patt=/^\d+s$/;null!=a.explicitDur&&!patt.test(a.explicitDur)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,
b,["explicitDur",a.explicitDur,values]);values=["true","false"];null!=a.freeze&&-1==jQuery.inArray(a.freeze,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["freeze",a.freeze,values]);attrs=["focusBorderColor","selBorderColor"];values="white,black,silver,gray,red,maroon,fuchsia,purple,lime,green,yellow,olive,blue,navy,aqua,teal".split(",");for(var f in attrs)attr=attrs[f],value=a[attr],null!=value&&-1==jQuery.inArray(value,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,[attr,value,values]);
values=["(n\ufffdmero inteiro)"];patt=/^-?\d+$/;null!=a.focusBorderWidth&&!patt.test(a.focusBorderWidth)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["focusBorderWidth",a.focusBorderWidth,values]);values=["(n\ufffdmero real entre 0 e 1)","(n\ufffdmero real entre 0 e 100)%"];patt=/^((0?\.\d+|1(\.0+)?)|(\d?\d?\.\d+|100(\.0+)?)%)$/;null!=a.focusBorderTransparency&&!patt.test(a.focusBorderTransparency)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["focusBorderTransparency",a.focusBorderTransparency,
values])};function debugDescriptorParam(a,b){values="background,balanceLevel,baseDeviceRegion,bassLevel,bottom,bounds,deviceClass,fit,fontColor,fontFamily,fontStyle,fontSize,fontVariant,fontWeight,height,left,location,plan,player,playerLife,reusePlayer,right,scroll,size,soundLevel,style,top,transInBorderColor,transInBorderWidth,transInDirection,transInDur,transInEndProgress,transInFadeColor,transInHorRepeat,transInStartProgress,transInSubtype,transInType,transInVertRepeat,transBorderColor,transOutBorderWidth,transOutDirection,transOutDur,transOutEndProgress,transOutFadeColor,transOutHorRepeat,transOutType,transOutStartProgress,transOutSubtype,transOutVertRepeat,transparency,trebleLevel,visible,width,zIndex".split(",");
null!=a.name&&-1==jQuery.inArray(a.name,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["name",a.name,values])};function debugDescriptorSwitch(){};function debugHead(){};function debugImportBase(a,b){if(null!=a.region){var c=Debugger.refTable.pop(a.region);!c||"region"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["region",a.region,["region"]]):a.region=c.obj}Debugger.uniqueTable.alias||(Debugger.uniqueTable.alias=[]);Debugger.uniqueTable.alias[a.alias]?Debugger.uniqueTable.alias[a.alias].duplicated||(Debugger.uniqueTable.alias[a.alias].duplicated=!0,Debugger.error(Debugger.ERR_DUPLICATED_ALIAS,"importBase",[a.alias])):Debugger.uniqueTable.alias[a.alias]=
{duplicated:!1}};function debugImportedDocumentBase(){};function debugImportNCL(a){Debugger.uniqueTable.alias||(Debugger.uniqueTable.alias=[]);Debugger.uniqueTable.alias[a.alias]?Debugger.uniqueTable.alias[a.alias].duplicated||(Debugger.uniqueTable.alias[a.alias].duplicated=!0,Debugger.error(Debugger.ERR_DUPLICATED_ALIAS,"importNCL",[a.alias])):Debugger.uniqueTable.alias[a.alias]={duplicated:!1}};function debugLink(a,b){if(null!=a.xconnector){var c=Debugger.refTable.pop(a.xconnector);!c||"causalConnector"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["xconnector",a.xconnector,["causalConnector"]]):a.xconnector=c.obj}};function debugLinkParam(a,b){if(null!=a.name){var c=Debugger.refTable.pop(a.name);!c||"connectorParam"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["name",a.name,["connectorParam"]]):a.name=c.obj}};function debugMapping(a,b){if(null!=a.component){var c=Debugger.refTable.pop(a.component);if(!c||"context"!=c.type&&"media"!=c.type)Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["component",a.component,["context","media"]]);else{if(null!=a.nodeInterface){var d=Debugger.refTable.pop(a.nodeInterface);!d||"context"==c.type&&"port"!=d.type||"media"==c.type&&"area"!=d.type&&"property"!=d.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["interface",a.nodeInterface,"context"==c.type?["port"]:
["area","property"]]):a.nodeInterface=d.obj}a.component=c.obj}}};function debugMedia(a,b){if(null!=a.refer){var c=Debugger.refTable.pop(a.refer);!c||"media"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["refer",a.refer,["media"]]):a.refer=c.obj}null!=a.descriptor&&(c=Debugger.refTable.pop(a.descriptor),!c||"descriptor"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["descriptor",a.descriptor,["descriptor"]]):a.descriptor=c.obj);values=["new","instSame","gradSame"];null!=a.instance&&-1==jQuery.inArray(a.instance,values)&&Debugger.error(Debugger.ERR_INVALID_ATTR_VALUE,
b,["instance",a.instance,values]);values="text/html,text/plain,text/css,text/xml,image/bmp,image/png,image/mng,image/gif,image/jpeg,audio/basic,audio/mp3,audio/mp2,audio/mpeg,audio/mpeg4,video/mpeg,application/x-ginga-NCLua,application/x-ginga-NCLet,application/x-ginga-settings,application/x-ginga-time,applications/x-ginga-NCL,application/x-ncl-NCL,application/x-ncl-NCLua,application/x-ncl-NCLet,application/x-ncl-settings,application/x-ncl-time".split(",");if(null!=a.type)if(-1==jQuery.inArray(a.type,
values))Debugger.error(ERR_INVALID_ATTR_VALUE,b,["type",a.type,values]);else if(null!=a.src)switch(c=a.src.split(".")[1],a.type){case "text/html":"htm"!=c&&"html"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"text/html",["htm","html"]]);break;case "text/plain":"txt"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"text/plain",["txt"]]);break;case "text/css":"css"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"text/css",["css"]]);break;case "text/xml":"xml"!=c&&
Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"text/xml",["xml"]]);break;case "image/bmp":"bmp"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"image/bmp",["bmp"]]);break;case "image/png":"png"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"image/png",["png"]]);break;case "image/gif":"gif"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"image/gif",["gif"]]);break;case "image/jpeg":"jpg"!=c&&"jpeg"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,
b,[c,"image/jpeg",["jpg","jpeg"]]);break;case "audio/basic":"wav"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"audio/basic",["wav"]]);break;case "audio/mp3":"mp3"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"audio/mp3",["mp3"]]);break;case "audio/mp2":"mp2"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"audio/mp2",["mp2"]]);break;case "audio/mpeg":"mpeg"!=c&&"mpg"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"audio/mpeg",["mpeg","mpg"]]);break;
case "audio/mpeg4":"mp4"!=c&&"mpg4"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"audio/mpeg4",["mp4","mpg4"]]);break;case "video/mpeg":"mpeg"!=c&&"mpg"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"video/mpeg",["mpeg","mpg"]]);break;case "application/x-ginga-NCLua":"lua"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,b,[c,"application/x-ginga-NCLua",["lua"]]);break;case "application/x-ginga-NCLet":"class"!=c&&"jar"!=c&&Debugger.error(Debugger.ERR_INCOMPATIBLE_FILE_EXT,
b,[c,"application/x-ginga-NCLet",["class","jar"]])}};function debugMetadata(){};function debugMeta(){};function debugNCL(a,b){values=["http://www.ncl.org.br/NCL3.0/EDTVProfile","http://www.ncl.org.br/NCL3.0/BDTVProfile","http://www.ncl.org.br/NCL3.0/CausalConnectorProfile"];null!=a.xmlns&&-1==jQuery.inArray(a.xmlns,values)&&Debugger.error(Debugger.ERR_INVALID_ATTR_VALUE,b,["xmlns",a.xmlns,values])};function debugPort(a,b){if(null!=a.component){var c=Debugger.refTable.pop(a.component);if(!c||"context"!=c.type&&"media"!=c.type)Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["component",a.component,["context","media"]]);else{if(null!=a.nodeInterface){var d=Debugger.refTable.pop(a.nodeInterface);!d||"context"==c.type&&"port"!=d.type||"media"==c.type&&"area"!=d.type&&"property"!=d.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["interface",a.nodeInterface,"context"==c.type?["port"]:
["area","property"]]):a.nodeInterface=d.obj}a.component=c.obj}}};function debugProperty(a){values="system.language,system.caption,system.subtitle,system.returnBitRate(i),system.screenSize,system.screenGraphicSize,system.audioType,system.screenSize(i),system.screenGraphicSize(i),system.audioType(i),system.devNumber(i),system.classType(i),system.info(i),system.classNumber,system.CPU,system.memory,system.operatingSystem,system.javaConfiguration,system.javaProfile,system.luaVersion,user.age,user.location,user.genre,default.focusBorderColor,default.selBorderColor,default.focusBorderWidth,default.focusBorderTransparency,service.currentFocus,service.currentKeyMaster,si.numberOfServices,si.numberOfPartialServices,si.channelNumber,channel.keyCapture,channel.virtualKeyBoard,channel.keyboardBounds".split(",");
null!=a.name&&-1==jQuery.inArray(a.name,values)&&(patt=/^system\.(returnBitRate|screenSize|screenGraphicSize|audioType|devNumber|classType|info)\(\d+\)$/,patt.test(a.name))};function debugRegionBase(a,b){values=["systemScreen(i)","systemAudio(i)"];patt=/^systemScreen\(\d+\)$|^systemAudio\(\d+\)$/;null!=a.device&&!patt.test(a.device)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["device",a.device,values])};function debugRegion(a,b,c){attrs="left,right,top,bottom,height,width".split(",");values=["(n\ufffdmero inteiro)","(n\ufffdmero inteiro)px","(n\ufffdmero real)%"];for(var d in attrs)attr=attrs[d],value=a[attr],null!=value&&(patt=/^(\d+|\d*\.\d+)px$|^(\d+|\d*\.\d+)%$|^(\d+|\d*\.\d+)$/,patt.test(value)||Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,[attr,value,values]));a.left&&a.right&&a.width&&isFinite(a.left)&&isFinite(a.right)&&isFinite(a.width)&&isFinite(c.width)&&(d=parseInt(a.left)+parseInt(a.right)+
parseInt(a.width),d!=c.width&&Debugger.warning(Debugger.WARN_INVALID_REGION_DIMENSIONS,"region",[["left","right","width"],d,c.width]));a.top&&a.bottom&&a.height&&isFinite(a.top)&&isFinite(a.bottom)&&isFinite(a.height)&&isFinite(c.height)&&(d=parseInt(a.top)+parseInt(a.bottom)+parseInt(a.height),d!=c.height&&Debugger.warning(Debugger.WARN_INVALID_REGION_DIMENSIONS,"region",[["top","bottom","height"],d,c.height]));values=["n\ufffdmero inteiro entre 0 e 255"];patt=/^\d+$/;null!=a.zIndex&&(!patt.test(a.zIndex)||
0>a.zIndex||255<a.zIndex)?Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["zIndex",a.zIndex,values]):(Debugger.uniqueTable.zIndex||(Debugger.uniqueTable.zIndex=[]),Debugger.uniqueTable.zIndex[a.zIndex]?Debugger.uniqueTable.zIndex[a.zIndex].duplicated||(Debugger.uniqueTable.zIndex[a.zIndex].duplicated=!0,Debugger.warning(Debugger.WARN_DUPLICATED_ZINDEX,"region",[a.zIndex])):Debugger.uniqueTable.zIndex[a.zIndex]={id:a.id,duplicated:!1})};function debugRuleBase(){};function debugRule(a,b){if(null!=a["var"]){var c=Debugger.refTable.pop(a["var"]);!c||"property"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["var",a["var"],["property"]]):a["var"]=c.obj}values="eq,ne,gt,lt,gte,lte".split(",");null!=a.comparator&&-1==jQuery.inArray(a.comparator,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["comparator",a.comparator,values])};function debugSimpleAction(a,b,c,d){values="start,stop,abort,pause,resume,set".split(",");null!=a.role&&-1==jQuery.inArray(a.role,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["role",a.role,values]);null!=a.role&&(-1==jQuery.inArray(a.role,values)?Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["role",a.role,values]):(c=d.split("causalConnector#")[1].split(">")[0],Debugger.uniqueTable["id#"+c]||(Debugger.uniqueTable["id#"+c]=[]),Debugger.uniqueTable["id#"+c][a.role]?Debugger.uniqueTable["id#"+
c][a.role].duplicated||(Debugger.uniqueTable["id#"+c][a.role].duplicated=!0,Debugger.error(Debugger.ERR_DUPLICATED_ATTR,"role",[a.role,c,["simpleAction","simpleCondition","attributeAssessment"]])):Debugger.uniqueTable["id#"+c][a.role]={duplicated:!1}));values=["start","stop","abort","pause","resume"];null!=a.actionType&&-1==jQuery.inArray(a.actionType,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["actionType",a.actionType,values]);values=["presentation","selection","attribution"];null!=a.eventType&&
-1==jQuery.inArray(a.eventType,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["eventType",a.eventType,values]);null==a.value&&("attribution"==a.eventType||"set"==a.role)&&Debugger.error(Debugger.ERR_MISSING_ATTR,b,["value"]);values=["(n\ufffdmero inteiro entre 1 e max)"];patt=/^\d+$/;null!=a.min&&(patt.test(a.min)?(1>parseInt(a.min)||null!=a.max&&"unbounded"!=a.max&&parseInt(a.max)<parseInt(a.min))&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["min",a.min,values]):Debugger.error(this.ERR_INVALID_ATTR_VALUE,
b,["min",a.min,values]));values=["(n\ufffdmero inteiro maior ou igual a min)","unbounded"];patt=/^(\d+|unbounded)$/;null!=a.max&&(patt.test(a.max)?"unbounded"!=a.max&&(1>parseInt(a.max)||null!=a.min&&parseInt(a.max)<parseInt(a.min))&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["max",a.max,values]):Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["max",a.max,values]));values=["par","seq"];null==a.qualifier?null!=a.min&&1<parseInt(a.min)?Debugger.error(Debugger.ERR_MISSING_ATTR,b,["qualifier"]):null!=
a.max&&("unbounded"==a.max||1<parseInt(a.max))&&Debugger.error(Debugger.ERR_MISSING_ATTR,b,["qualifier"]):-1==jQuery.inArray(a.qualifier,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["qualifier",a.qualifier,values]);values=["(n\ufffdmero inteiro positivo)"];patt=/^\d+$/;null!=a.repeat&&!patt.test(a.repeat)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["repeat",a.repeat,values]);values=["(n\ufffdmero inteiro positivo)s"];patt=/^\d+s$/;null!=a.duration&&!patt.test(a.duration)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,
b,["duration",a.duration,values])};function debugSimpleCondition(a,b,c,d){values="onBegin,onEnd,onAbort,onPause,onResume,onSelection,onBeginAttribution,onEndAttribution".split(",");null!=a.role&&-1==jQuery.inArray(a.role,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["role",a.role,values]);null!=a.role&&(-1==jQuery.inArray(a.role,values)?Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["role",a.role,values]):(c=d.split("causalConnector#")[1].split(">")[0],Debugger.uniqueTable["id#"+c]||(Debugger.uniqueTable["id#"+c]=[]),Debugger.uniqueTable["id#"+
c][a.role]?Debugger.uniqueTable["id#"+c][a.role].duplicated||(Debugger.uniqueTable["id#"+c][a.role].duplicated=!0,Debugger.error(Debugger.ERR_DUPLICATED_ATTR,"role",[a.role,c,["simpleAction","simpleCondition","attributeAssessment"]])):Debugger.uniqueTable["id#"+c][a.role]={duplicated:!1}));values=["starts","stops","pauses","resumes","aborts"];null!=a.transition&&-1==jQuery.inArray(a.transition,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["transition",a.transition,values]);values=["presentation",
"selection","attribution"];null!=a.eventType&&-1==jQuery.inArray(a.eventType,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["eventType",a.eventType,values]);values="0-9,A-Z,*,#,MENU,INFO,GUIDE,CURSOR_DOWN,CURSOR_LEFT,CURSOR_RIGHT,CURSOR_UP,CHANNEL_DOWN,CHANNEL_UP,VOLUME_DOWN,VOLUME_UP,ENTER,RED,GREEN,YELLOW,BLUE,BACK,EXIT,POWER,REWIND,STOP,EJECT,PLAY,RECORD,PAUSE".split(",");patt=/^([0-9A-Z]|\*|#|MENU|INFO|GUIDE|CURSOR_DOWN|CURSOR_LEFT|CURSOR_RIGHT|CURSOR_UP|CHANNEL_DOWN|CHANNEL_UP|VOLUME_DOWN|VOLUME_UP|ENTER|RED|GREEN|YELLOW|BLUE|BACK|EXIT|POWER|REWIND|STOP|EJECT|PLAY|RECORD|PAUSE)$/;
null!=a.key&&!patt.test(a.key)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["key",a.key,values]);values=["(n\ufffdmero inteiro entre 1 e max)"];patt=/^\d+$/;null!=a.min&&(patt.test(a.min)?(1>parseInt(a.min)||null!=a.max&&"unbounded"!=a.max&&parseInt(a.max)<parseInt(a.min))&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["min",a.min,values]):Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["min",a.min,values]));values=["(n\ufffdmero inteiro maior ou igual a min)","unbounded"];patt=/^(\d+|unbounded)$/;
null!=a.max&&(patt.test(a.max)?"unbounded"!=a.max&&(1>parseInt(a.max)||null!=a.min&&parseInt(a.max)<parseInt(a.min))&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["max",a.max,values]):Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["max",a.max,values]));values=["and","or"];null==a.qualifier?null!=a.min&&1<parseInt(a.min)?Debugger.error(Debugger.ERR_MISSING_ATTR,b,["qualifier"]):null!=a.max&&("unbounded"==a.max||1<parseInt(a.max))&&Debugger.error(Debugger.ERR_MISSING_ATTR,b,["qualifier"]):-1==jQuery.inArray(a.qualifier,
values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["qualifier",a.qualifier,values])};function debugSwitch(a,b){if(null!=a.refer){var c=Debugger.refTable.pop(a.refer);!c||"switch"!=c.type?Debugger.error(Debugger.ERR_INVALID_ID_REFERENCE,b,["refer",a.refer,["switch"]]):a.refer=c.obj}};function debugSwitchPort(){};function debugTransitionBase(){};function debugTransition(a,b){values=["barWipe","irisWipe","clockWipe","snakeWipe","fade"];null!=a.type&&-1==jQuery.inArray(a.type,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["type",a.type,values]);values=["(n\ufffdmero inteiro positivo)s"];patt=/^\d+s$/;null!=a.dur&&!patt.test(a.dur)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["dur",a.dur,values]);values=["(n\ufffdmero real entre 0 e 1)"];patt=/^(0*\.\d+|1\.0)$/;null!=a.startProgress&&!patt.test(a.startProgress)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,
b,["startProgress",a.startProgress,values]);null!=a.endProgress&&!patt.test(a.endProgress)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["endProgress",a.endProgress,values]);values=["forward","reverse"];null!=a.direction&&-1==jQuery.inArray(a.direction,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["direction",a.direction,values]);values="white,black,silver,gray,red,maroon,fuchsia,purple,lime,green,yellow,olive,blue,navy,aqua,teal".split(",");null!=a.fadeColor&&-1==jQuery.inArray(a.fadeColor,
values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["fadeColor",a.fadeColor,values]);values=["(n\ufffdmero inteiro n\ufffdo negativo)"];patt=/^\d+$/;null!=a.horRepeat&&-1==patt.test(a.horRepeat,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["horRepeat",a.horRepeat,values]);values=["(n\ufffdmero inteiro n\ufffdo negativo)"];patt=/^\d+$/;null!=a.vertRepeat&&-1==patt.test(a.vertRepeat,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["vertRepeat",a.vertRepeat,values]);values=["(n\ufffdmero inteiro n\ufffdo negativo)"];
patt=/^\d+$/;null!=a.borderWidth&&-1==patt.test(a.borderWidth,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["borderWidth",a.borderWidth,values]);values="white,black,silver,gray,red,maroon,fuchsia,purple,lime,green,yellow,olive,blue,navy,aqua,teal,blend".split(",");null!=a.borderColor&&-1==jQuery.inArray(a.borderColor,values)&&Debugger.error(this.ERR_INVALID_ATTR_VALUE,b,["borderColor",a.borderColor,values])};function debugValueAssessment(){};
